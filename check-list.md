# CHECK LIST: Подготовка инфраструктуры до и после проектирования микросервисов

---

## 1. Что нужно сделать сейчас (до появления архитектуры микросервисов)

### 1.1. Базовая инфраструктура
- [ ] Настроить и протестировать Docker Compose, сети, volume, базовые сервисы (MySQL, Redis, RabbitMQ, Vault, Prometheus, Grafana, ELK)
  - [ ] Все сервисы стартуют и доступны по нужным адресам
  - [ ] Все volumes и сети корректно проброшены
  - [ ] Нет лишних открытых портов наружу
- [ ] Централизованное логирование (Logstash → Elasticsearch → Kibana)
  - [ ] Logstash видит и обрабатывает тестовые логи
  - [ ] В Elasticsearch появляются индексы logs-*
  - [ ] Kibana подключена к Elasticsearch
- [ ] Мониторинг инфраструктуры (Prometheus, Grafana, Alertmanager)
  - [ ] Prometheus собирает метрики с инфраструктурных сервисов
  - [ ] Grafana отображает базовые дашборды (нагрузка, память, CPU, диски)
  - [ ] Alertmanager может отправлять тестовые алерты
- [ ] Настроить firewall для инфраструктурных сервисов
  - [ ] Разрешены только нужные порты
  - [ ] Админ-панели доступны только из доверенных сетей
- [ ] Настроить HTTPS для публичных сервисов (API Gateway, Grafana и т.д.)
  - [ ] Сертификаты установлены
  - [ ] Работает автоматическое обновление сертификатов (если нужно)
- [ ] Настроить хранение секретов (Vault)
  - [ ] Vault доступен только из backend-сети
  - [ ] Секреты можно безопасно получать из Vault
- [ ] Проверить автоматический деплой (CI/CD)
  - [ ] Изменения из репозитория попадают на сервер
  - [ ] Деплой не требует ручных действий
- [ ] Документировать инфраструктуру
  - [ ] Описаны все доступы, пароли, токены, адреса сервисов (в защищённом месте)
  - [ ] Описана структура docker-compose, связи между сервисами, порты, volume
  - [ ] Описан процесс деплоя, обновления, восстановления
  - [ ] Описан процесс добавления нового сервиса
- [ ] Smoke-тесты инфраструктуры
  - [ ] Проверить, что все сервисы стартуют с нуля (docker-compose up)
  - [ ] Проверить, что все сервисы корректно завершают работу (docker-compose down)
  - [ ] Проверить, что все переменные окружения заданы и не содержат секретов в открытом виде
  - [ ] Проверить, что все контейнеры используют только необходимые volume и сети

---

## 2. Что делать после появления архитектуры микросервисов

- Создать отдельные базы данных для каждого микросервиса
- Настроить пользователей и права доступа для каждого сервиса
- Реализовать и протестировать миграции схем
- Настроить очереди в RabbitMQ для всех сервисов, которые будут использовать асинхронные задачи
- Настроить кэширование в Redis (разделить пространства ключей для разных сервисов)
- Протестировать работу очередей и кэша
- Стандартизировать формат логов, трассировку, интеграцию с Logstash
- Настроить дашборды и алерты для бизнес-метрик микросервисов
- Реализовать smoke-тесты, интеграционные тесты, тестовые данные для сервисов
- Настроить CI/CD для микросервисов
- Описать процесс деплоя, обновления, восстановления для каждого сервиса

---

> **Этот файл — рабочий чек-лист подготовки инфраструктуры. Отмечайте выполненные пункты и дополняйте по мере развития проекта.** 